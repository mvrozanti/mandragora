#!/bin/bash

# Get all sink names in an array
sinks=( $(pactl list short sinks | awk '{print $2}') )

# Get current default sink
current=$(pactl info | grep "Default Sink" | awk '{print $3}')

# Find index of current sink and calculate next
for i in "${!sinks[@]}"; do
    if [[ "${sinks[$i]}" == "$current" ]]; then
        next_index=$(( (i+1) % ${#sinks[@]} ))
        break
    fi
done

# Set the next sink as default
next_sink="${sinks[$next_index]}"
pactl set-default-sink "$next_sink"

# Move all playing streams to the new sink
for stream in $(pactl list short sink-inputs | awk '{print $1}'); do
    pactl move-sink-input "$stream" "$next_sink"
done

# Send notification with the new sink name
notify-send "Audio Output Switched" "Current sink: $next_sink"

